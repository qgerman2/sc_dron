clc; clearvars; close all
syms k d m L g Ixx Iyy Izz s

A = [
    0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, g, 0, 0, 0;
    0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0,-g, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
];

B = [
             0,        0,       0,       0,   0,   0;
             0,        0,       0,       0, 1/m,   0;
             0,        0,       0,       0,   0,   0;
             0,        0,       0,       0,   0, 1/m;
             0,        0,       0,       0,   0,   0;
           k/m,      k/m,     k/m,     k/m,   0,   0;
             0,        0,       0,       0,   0,   0;
             0, -L*k/Ixx,       0, L*k/Ixx,   0,   0;
             0,        0,       0,       0,   0,   0;
      -L*k/Iyy,        0, L*k/Iyy,       0,   0,   0;
             0,        0,       0,       0,   0,   0;
         d/Izz,   -d/Izz,   d/Izz,  -d/Izz,   0,   0;
];

C = [
    1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
];

D = [
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
];
%Matriz resultante
R = C*inv(s*eye(12)-A)*B
R = subs(R, ...
    {   k,      d,   L,     Ixx,     Iyy,    Izz,     m,    g}, ... 
    {3E-6, 7.5E-7, 0.3, 8.15E-2, 8.15E-2, 1.28E-1, 8.01, 9.81} ...
)
%Valores propios
x = eig (R)

%Root Locus
K = 0:0.1:400;
r = rlocus(A,B,C,D,K);
plot(r,'o');
v = [-6 6 -6 6];
grid;
title('Lugar de las ra√≠ces del sistema definido en el espacio de estados')
